function [KernelVxxy]=Tesseroid_IntegralkernelVxxy(R2,R1,FaiI,LamdaI,r,fai,lamda)

h2=r-R2;
hRatio2=h2/r;
h1=r-R1;
hRatio1=h1/r;

R2=1-hRatio2;
R1=1-hRatio1;
Phi=atan2(sqrt((cosd(FaiI).*sind(LamdaI-lamda)).^2+(cosd(fai).*sind(FaiI)-sind(fai).*cosd(FaiI).*cosd(LamdaI-lamda)).^2),...
    sind(fai).*sind(FaiI)+cosd(fai).*cosd(FaiI).*cosd(LamdaI-lamda));
Alpha=atan2(sind(LamdaI-lamda).*cosd(FaiI),cosd(fai).*sind(FaiI)-sind(fai).*cosd(FaiI).*cosd(LamdaI-lamda));

l2pow3=(2.*(2.*sin(Phi/2).^2).*(1-hRatio2)+hRatio2.^2).^(1.5);
l1pow3=(2.*(2.*sin(Phi/2).^2).*(1-hRatio1)+hRatio1.^2).^(1.5);

l2pow5=(2.*(2.*sin(Phi/2).^2).*(1-hRatio2)+hRatio2.^2).^(2.5);
l1pow5=(2.*(2.*sin(Phi/2).^2).*(1-hRatio1)+hRatio1.^2).^(2.5);

KernelVxxy=-cosd(FaiI).*sin(Alpha).*csc(Phi).^3.*(...
    cos(Alpha).^2.*8.*...
    ((1-R2.*cos(Phi)).*l1pow5-(1-R1.*cos(Phi)).*l2pow5)./(l2pow5.*l1pow5)-...
    cos(Alpha).^2.*32.*cos(Phi).*...
    (R2.*(1-R2.*cos(Phi)).*l1pow5-R1.*(1-R1.*cos(Phi)).*l2pow5)./(l2pow5.*l1pow5)+...
    cos(Alpha).^2.*4.*(5+7.*cos(Phi).^2).*...
    (R2.^2.*(1-R2.*cos(Phi)).*l1pow5-R1.^2.*(1-R1.*cos(Phi)).*l2pow5)./(l2pow5.*l1pow5)+...
    cos(Alpha).^2.*4.*cos(Phi).*(-9+cos(2.*Phi)).*...
    (R2.^3.*(1-R2.*cos(Phi)).*l1pow5-R1.^3.*(1-R1.*cos(Phi)).*l2pow5)./(l2pow5.*l1pow5)+...
    cos(Alpha).^2.*(15-10.*cos(Phi).^2+3.*cos(Phi).^4).*...
    (R2.^4.*(1-R2.*cos(Phi)).*l1pow5-R1.^4.*(1-R1.*cos(Phi)).*l2pow5)./(l2pow5.*l1pow5)+...
    -2.*...
    ((1-R2.*cos(Phi)).*l1pow3-(1-R1.*cos(Phi)).*l2pow3)./(l2pow3.*l1pow3)+...
    4.*cos(Phi).*...
    (R2.*(1-R2.*cos(Phi)).*l1pow3-R1.*(1-R1.*cos(Phi)).*l2pow3)./(l2pow3.*l1pow3)+...
    (-3+cos(Phi).^2).*...
    (R2.^2.*(1-R2.*cos(Phi)).*l1pow3-R1.^2.*(1-R1.*cos(Phi)).*l2pow3)./(l2pow3.*l1pow3));

Index1=Phi<(pi/2-acos(1e-5));
Index2=Phi>(pi/2+acos(1e-5));
KernelVxxy(Index1)=0;
KernelVxxy(Index2)=0;

end